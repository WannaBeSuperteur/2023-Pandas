## example 1
다음 DataFrame에서 열 A는 표준정규분포로 표준화하고, B는 ```log(x + 1, base = 2)```를 먼저 한 다음 표준정규분포로 표준화하시오.
```python
>>> df
          A         B
0  6.036478  4.939135
1  5.470579  4.939030
2  3.624474  5.840502
3  4.580822  5.941228
4  4.450411  4.771837
5  3.419930  3.675808
6  5.107021  3.393145
7  5.177033  4.951316
8  6.045281  5.021059
9  6.095670  3.223533
```

코드 및 실행 결과 :
```python
>>> A_mean = df['A'].mean()
>>> A_std = df['A'].std()
>>> df['A'] = df['A'].apply(lambda x: (x - A_mean) / A_std)
>>> 
>>> df['B'] = df['B'].apply(lambda x: np.log2(x + 1.0))
>>> df['B']
0    2.570253
1    2.570227
2    2.774102
3    2.795191
4    2.529031
5    2.225216
6    2.135254
7    2.573209
8    2.590017
9    2.078450
Name: B, dtype: float64
>>> B_mean = df['B'].mean()
>>> B_std = df['B'].std()
>>> df['B'] = df['B'].apply(lambda x: (x - B_mean) / B_std)
>>> df
          A         B
0  1.065855  0.342308
1  0.483485  0.342206
2 -1.416357  1.152207
3 -0.432172  1.235993
4 -0.566379  0.178531
5 -1.626855 -1.028535
6  0.109344 -1.385955
7  0.181393  0.354051
8  1.074914  0.420832
9  1.126771 -1.611638
```

## example 2 ~ 4
### example 2
다음 DataFrame에서 100 이상인 값을 다음과 같이 각각 처리하시오.
* 모두 100으로 처리하기
* 100을 초과하는 값은 null로 처리하기
* 100을 초과하는 값이 있는 행을 모두 제거하기
```python
>>> df
       K      M      E
0   60.0   63.0   63.0
1   72.0   80.0   65.0
2   59.0   65.0   57.0
3   68.0   73.0   77.0
4   78.0  103.0   70.0
5   42.0   68.0   77.0
6   38.0   95.0   74.0
7   72.0   72.0   77.0
8   59.0   78.0   75.0
9   92.0  102.0   94.0
10  87.0   70.0   90.0
11  55.0   66.0   65.0
12  82.0   55.0   91.0
13  32.0   67.0   62.0
14  78.0   56.0   59.0
15  58.0   67.0   81.0
16  74.0   71.0   65.0
17  95.0   58.0   75.0
18  67.0   53.0  104.0
19  79.0   53.0   69.0
```

* **모두 100으로 처리하기**
코드 및 실행 결과 :
```python
>>> df.apply(lambda x: np.minimum(x, 100))
       K      M      E
0   60.0   63.0   63.0
1   72.0   80.0   65.0
2   59.0   65.0   57.0
3   68.0   73.0   77.0
4   78.0  100.0   70.0
5   42.0   68.0   77.0
6   38.0   95.0   74.0
7   72.0   72.0   77.0
8   59.0   78.0   75.0
9   92.0  100.0   94.0
10  87.0   70.0   90.0
11  55.0   66.0   65.0
12  82.0   55.0   91.0
13  32.0   67.0   62.0
14  78.0   56.0   59.0
15  58.0   67.0   81.0
16  74.0   71.0   65.0
17  95.0   58.0   75.0
18  67.0   53.0  100.0
19  79.0   53.0   69.0
```

* **100을 초과하는 값은 null로 처리하기**
코드 및 실행 결과 :
```python
>>> df.where(df <= 100)
       K     M     E
0   60.0  63.0  63.0
1   72.0  80.0  65.0
2   59.0  65.0  57.0
3   68.0  73.0  77.0
4   78.0   NaN  70.0
5   42.0  68.0  77.0
6   38.0  95.0  74.0
7   72.0  72.0  77.0
8   59.0  78.0  75.0
9   92.0   NaN  94.0
10  87.0  70.0  90.0
11  55.0  66.0  65.0
12  82.0  55.0  91.0
13  32.0  67.0  62.0
14  78.0  56.0  59.0
15  58.0  67.0  81.0
16  74.0  71.0  65.0
17  95.0  58.0  75.0
18  67.0  53.0   NaN
19  79.0  53.0  69.0
```

* **100을 초과하는 값이 있는 행을 모두 제거하기**
코드 및 실행 결과 :
```python
>>> df.loc[lambda x: (x['K'] <= 100) & (x['M'] <= 100) & (x['E'] <= 100), :]
       K     M     E
0   60.0  63.0  63.0
1   72.0  80.0  65.0
2   59.0  65.0  57.0
3   68.0  73.0  77.0
5   42.0  68.0  77.0
6   38.0  95.0  74.0
7   72.0  72.0  77.0
8   59.0  78.0  75.0
10  87.0  70.0  90.0
11  55.0  66.0  65.0
12  82.0  55.0  91.0
13  32.0  67.0  62.0
14  78.0  56.0  59.0
15  58.0  67.0  81.0
16  74.0  71.0  65.0
17  95.0  58.0  75.0
19  79.0  53.0  69.0
```

### example 3
```example 2```에서 100 이상인 값을 모두 100으로 처리하고 난 다음의 데이터는 다음과 같다.
```python
>>> df
       K      M      E
0   60.0   63.0   63.0
1   72.0   80.0   65.0
2   59.0   65.0   57.0
3   68.0   73.0   77.0
4   78.0  100.0   70.0
5   42.0   68.0   77.0
6   38.0   95.0   74.0
7   72.0   72.0   77.0
8   59.0   78.0   75.0
9   92.0  100.0   94.0
10  87.0   70.0   90.0
11  55.0   66.0   65.0
12  82.0   55.0   91.0
13  32.0   67.0   62.0
14  78.0   56.0   59.0
15  58.0   67.0   81.0
16  74.0   71.0   65.0
17  95.0   58.0   75.0
18  67.0   53.0  100.0
19  79.0   53.0   69.0
```

여기서 다음의 작업을 차례대로 수행하시오.
* 1. K, M, E 열의 값의 평균을 구하시오. 이때 K, M, E 값의 가중치는 각각 30%, 40%, 30%이다.
* 2. 1번에서 구한 평균값이 전체 중에서 상위 20% 이내이면 A, 상위 50% 이내이면 B, 나머지는 C를 부여한다.

코드 및 실행 결과 :
```python
>>> df['avg'] = df.apply(lambda x: 0.3 * x['K'] + 0.4 * x['M'] + 0.3 * x['E'], axis = 1)
>>> df
       K      M      E   avg
0   60.0   63.0   63.0  62.1
1   72.0   80.0   65.0  73.1
2   59.0   65.0   57.0  60.8
3   68.0   73.0   77.0  72.7
4   78.0  100.0   70.0  84.4
5   42.0   68.0   77.0  62.9
6   38.0   95.0   74.0  71.6
7   72.0   72.0   77.0  73.5
8   59.0   78.0   75.0  71.4
9   92.0  100.0   94.0  95.8
10  87.0   70.0   90.0  81.1
11  55.0   66.0   65.0  62.4
12  82.0   55.0   91.0  73.9
13  32.0   67.0   62.0  55.0
14  78.0   56.0   59.0  63.5
15  58.0   67.0   81.0  68.5
16  74.0   71.0   65.0  70.1
17  95.0   58.0   75.0  74.2
18  67.0   53.0  100.0  71.3
19  79.0   53.0   69.0  65.6
>>> df['rank'] = df.apply(lambda x: len(df[df['avg'] >= x['avg']]), axis = 1)
>>> df
       K      M      E   avg  rank
0   60.0   63.0   63.0  62.1    18
1   72.0   80.0   65.0  73.1     7
2   59.0   65.0   57.0  60.8    19
3   68.0   73.0   77.0  72.7     8
4   78.0  100.0   70.0  84.4     2
5   42.0   68.0   77.0  62.9    16
6   38.0   95.0   74.0  71.6     9
7   72.0   72.0   77.0  73.5     6
8   59.0   78.0   75.0  71.4    10
9   92.0  100.0   94.0  95.8     1
10  87.0   70.0   90.0  81.1     3
11  55.0   66.0   65.0  62.4    17
12  82.0   55.0   91.0  73.9     5
13  32.0   67.0   62.0  55.0    20
14  78.0   56.0   59.0  63.5    15
15  58.0   67.0   81.0  68.5    13
16  74.0   71.0   65.0  70.1    12
17  95.0   58.0   75.0  74.2     4
18  67.0   53.0  100.0  71.3    11
19  79.0   53.0   69.0  65.6    14
>>> df['top'] = df.apply(lambda x: x['rank'] / len(df), axis = 1)
>>> df
       K      M      E   avg  rank   top
0   60.0   63.0   63.0  62.1    18  0.90
1   72.0   80.0   65.0  73.1     7  0.35
2   59.0   65.0   57.0  60.8    19  0.95
3   68.0   73.0   77.0  72.7     8  0.40
4   78.0  100.0   70.0  84.4     2  0.10
5   42.0   68.0   77.0  62.9    16  0.80
6   38.0   95.0   74.0  71.6     9  0.45
7   72.0   72.0   77.0  73.5     6  0.30
8   59.0   78.0   75.0  71.4    10  0.50
9   92.0  100.0   94.0  95.8     1  0.05
10  87.0   70.0   90.0  81.1     3  0.15
11  55.0   66.0   65.0  62.4    17  0.85
12  82.0   55.0   91.0  73.9     5  0.25
13  32.0   67.0   62.0  55.0    20  1.00
14  78.0   56.0   59.0  63.5    15  0.75
15  58.0   67.0   81.0  68.5    13  0.65
16  74.0   71.0   65.0  70.1    12  0.60
17  95.0   58.0   75.0  74.2     4  0.20
18  67.0   53.0  100.0  71.3    11  0.55
19  79.0   53.0   69.0  65.6    14  0.70
>>> df['level'] = df.apply(lambda x: get_level(x['top']), axis = 1)
>>> df
       K      M      E   avg  rank   top level
0   60.0   63.0   63.0  62.1    18  0.90     C
1   72.0   80.0   65.0  73.1     7  0.35     B
2   59.0   65.0   57.0  60.8    19  0.95     C
3   68.0   73.0   77.0  72.7     8  0.40     B
4   78.0  100.0   70.0  84.4     2  0.10     A
5   42.0   68.0   77.0  62.9    16  0.80     C
6   38.0   95.0   74.0  71.6     9  0.45     B
7   72.0   72.0   77.0  73.5     6  0.30     B
8   59.0   78.0   75.0  71.4    10  0.50     B
9   92.0  100.0   94.0  95.8     1  0.05     A
10  87.0   70.0   90.0  81.1     3  0.15     A
11  55.0   66.0   65.0  62.4    17  0.85     C
12  82.0   55.0   91.0  73.9     5  0.25     B
13  32.0   67.0   62.0  55.0    20  1.00     C
14  78.0   56.0   59.0  63.5    15  0.75     C
15  58.0   67.0   81.0  68.5    13  0.65     C
16  74.0   71.0   65.0  70.1    12  0.60     C
17  95.0   58.0   75.0  74.2     4  0.20     A
18  67.0   53.0  100.0  71.3    11  0.55     C
19  79.0   53.0   69.0  65.6    14  0.70     C
```

### example 4
```example 3```의 결과물 데이터에서 각 등급 (A, B, C) 별 K, M, E 열의 값의 평균을 구하시오. 이때 각 행이 속한 등급별로 열을 추가하여 표시한다.

코드 및 실행 결과 :
```python
>>> df['K_avg'] = df.apply(lambda x: df[df['level'] == x['level']]['K'].mean(), axis = 1)
>>> df['M_avg'] = df.apply(lambda x: df[df['level'] == x['level']]['M'].mean(), axis = 1)
>>> df['E_avg'] = df.apply(lambda x: df[df['level'] == x['level']]['E'].mean(), axis = 1)
>>> df
       K      M      E   avg  rank   top level      K_avg  M_avg  E_avg
0   60.0   63.0   63.0  62.1    18  0.90     C  60.400000   62.9  69.80
1   72.0   80.0   65.0  73.1     7  0.35     B  65.166667   75.5  76.50
2   59.0   65.0   57.0  60.8    19  0.95     C  60.400000   62.9  69.80
3   68.0   73.0   77.0  72.7     8  0.40     B  65.166667   75.5  76.50
4   78.0  100.0   70.0  84.4     2  0.10     A  88.000000   82.0  82.25
5   42.0   68.0   77.0  62.9    16  0.80     C  60.400000   62.9  69.80
6   38.0   95.0   74.0  71.6     9  0.45     B  65.166667   75.5  76.50
7   72.0   72.0   77.0  73.5     6  0.30     B  65.166667   75.5  76.50
8   59.0   78.0   75.0  71.4    10  0.50     B  65.166667   75.5  76.50
9   92.0  100.0   94.0  95.8     1  0.05     A  88.000000   82.0  82.25
10  87.0   70.0   90.0  81.1     3  0.15     A  88.000000   82.0  82.25
11  55.0   66.0   65.0  62.4    17  0.85     C  60.400000   62.9  69.80
12  82.0   55.0   91.0  73.9     5  0.25     B  65.166667   75.5  76.50
13  32.0   67.0   62.0  55.0    20  1.00     C  60.400000   62.9  69.80
14  78.0   56.0   59.0  63.5    15  0.75     C  60.400000   62.9  69.80
15  58.0   67.0   81.0  68.5    13  0.65     C  60.400000   62.9  69.80
16  74.0   71.0   65.0  70.1    12  0.60     C  60.400000   62.9  69.80
17  95.0   58.0   75.0  74.2     4  0.20     A  88.000000   82.0  82.25
18  67.0   53.0  100.0  71.3    11  0.55     C  60.400000   62.9  69.80
19  79.0   53.0   69.0  65.6    14  0.70     C  60.400000   62.9  69.80
```

## example 5
```python
>>> df
       K     M     E
0    1.0   5.0   0.0
1    4.0   9.0  -2.0
2    3.0   1.0   7.0
3   11.0   9.0   4.0
4    6.0   4.0   4.0
5    3.0   6.0  11.0
6    6.0  10.0   5.0
7    9.0   8.0   4.0
8    7.0   4.0   4.0
9    5.0   7.0  10.0
10   2.0  13.0   8.0
11   5.0   6.0   4.0
12   5.0   6.0   8.0
13   5.0   5.0   6.0
14  11.0   4.0   2.0
15   2.0   5.0   2.0
16  11.0   1.0   5.0
17   6.0  14.0   8.0
18   5.0   2.0   0.0
19   9.0   6.0  -1.0
```

위 dataset에서 다음 순서대로 작업을 수행하시오.
* 0 미만의 값과 10 초과의 값들을 모두 null 값으로 바꾼다.
* 모든 null 값들을 다음의 방법으로 각각 변환한다.
  * 같은 열에 있는 null이 아닌 값들의 평균값
  * 같은 열에 있는 null이 아닌 값들의 최빈값

코드 및 실행 결과 :
```python
>>> df2 = df2.where((df2 >= 0) & (df2 <= 10))
>>> df2
      K     M     E
0   1.0   5.0   0.0
1   4.0   9.0   NaN
2   3.0   1.0   7.0
3   NaN   9.0   4.0
4   6.0   4.0   4.0
5   3.0   6.0   NaN
6   6.0  10.0   5.0
7   9.0   8.0   4.0
8   7.0   4.0   4.0
9   5.0   7.0  10.0
10  2.0   NaN   8.0
11  5.0   6.0   4.0
12  5.0   6.0   8.0
13  5.0   5.0   6.0
14  NaN   4.0   2.0
15  2.0   5.0   2.0
16  NaN   1.0   5.0
17  6.0   NaN   8.0
18  5.0   2.0   0.0
19  9.0   6.0   NaN

>>> for column in df2.columns:
	df2[column] = df2[column].where(~df2[column].isnull(), df2[column].mean())

	
>>> df2
           K          M          E
0   1.000000   5.000000   0.000000
1   4.000000   9.000000   4.764706
2   3.000000   1.000000   7.000000
3   4.882353   9.000000   4.000000
4   6.000000   4.000000   4.000000
5   3.000000   6.000000   4.764706
6   6.000000  10.000000   5.000000
7   9.000000   8.000000   4.000000
8   7.000000   4.000000   4.000000
9   5.000000   7.000000  10.000000
10  2.000000   5.444444   8.000000
11  5.000000   6.000000   4.000000
12  5.000000   6.000000   8.000000
13  5.000000   5.000000   6.000000
14  4.882353   4.000000   2.000000
15  2.000000   5.000000   2.000000
16  4.882353   1.000000   5.000000
17  6.000000   5.444444   8.000000
18  5.000000   2.000000   0.000000
19  9.000000   6.000000   4.764706

>>> df2 = df.copy()
>>> df2 = df2.where((df2 >= 0) & (df2 <= 10))
>>> df3 = df2.copy()
>>> for column in df3.columns:
	df3[column] = df3[column].where(~df3[column].isnull(), df3[column].mode()[0])

>>> df3
      K     M     E
0   1.0   5.0   0.0
1   4.0   9.0   4.0
2   3.0   1.0   7.0
3   5.0   9.0   4.0
4   6.0   4.0   4.0
5   3.0   6.0   4.0
6   6.0  10.0   5.0
7   9.0   8.0   4.0
8   7.0   4.0   4.0
9   5.0   7.0  10.0
10  2.0   6.0   8.0
11  5.0   6.0   4.0
12  5.0   6.0   8.0
13  5.0   5.0   6.0
14  5.0   4.0   2.0
15  2.0   5.0   2.0
16  5.0   1.0   5.0
17  6.0   6.0   8.0
18  5.0   2.0   0.0
19  9.0   6.0   4.0
```
