from https://pandas.pydata.org/docs/user_guide/indexing.html

## basic of modifying data
* **0100** basic of modifying data from a range of dataset (1)
```python
>>> df = pd.DataFrame(np.random.randn(10, 4), columns = ['A', 'B', 'C', 'D'])
>>> df
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2 = df.copy()
>>> 
>>> df2['A'].loc[2] = 0
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2  0.000000 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
```

* **0101** basic of modifying data from a range of dataset (2)
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.iloc[3:4, 1:] = 0
>>> df2.iloc[[2, 6, 7], [2, 3]] = 1
>>> df2.iloc[9, :] = 2
>>> df2['C'].iloc[6:] = 3
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  1.000000  1.000000
3 -0.546297  0.000000  0.000000  0.000000
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373  3.000000  1.000000
7 -0.607206  0.914894  3.000000  1.000000
8  0.447207  1.145699  3.000000  0.647402
9  2.000000  2.000000  3.000000  2.000000
```

* **0102** modifying by conditions on a ```DataFrame``` (1)
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.loc[lambda x: x['A'] > 0, ['B', 'C']] = 0
>>> df2.loc[lambda x: x['B'] + x['D'] > 0, ['A']] = 1
>>> df2.loc[lambda x: x['D'] >= 0.5, ['D']] = 2
>>> df2
          A         B         C         D
0  1.000000  0.491618  0.129576  2.000000
1 -2.084405 -1.102188  0.672435 -0.464113
2  1.000000 -1.084836  0.507769  2.000000
3  1.000000  0.144294 -0.569923  0.064194
4  1.000000  0.000000  0.000000  2.000000
5  1.000000  0.000000  0.000000  2.000000
6  1.000000  0.000000  0.000000  0.481558
7  1.000000  0.914894 -0.298573 -0.698149
8  1.000000  0.000000  0.000000  2.000000
9  1.713506  0.000000  0.000000 -1.780587
```

* **0103** modifying by conditions on a ```DataFrame``` (2)
```python
>>> df
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2 = df.copy()
>>> df2[df2 < -0.5] = 0.5
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1  0.500000  0.500000  0.672435 -0.464113
2 -0.334768  0.500000  0.507769  1.186962
3  0.500000  0.144294  0.500000  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812  0.500000  0.500000  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7  0.500000  0.914894 -0.298573  0.500000
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388  0.500000
>>> df2 = df.copy()
>>> df2[df2[1:5] >= 0.5] = 0.5
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.500000 -0.464113
2 -0.334768 -1.084836  0.500000  0.500000
3 -0.546297  0.144294 -0.569923  0.064194
4  0.500000  0.080845  0.500000  0.500000
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
```

* **0104** modifying by conditions on a ```Series```
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> s = df2['A']
>>> s[(s < -0.5) | (s > 0.5)] = 0
>>> s
0   -0.004321
1    0.000000
2   -0.334768
3    0.000000
4    0.000000
5    0.041812
6    0.097567
7    0.000000
8    0.447207
9    0.000000
Name: A, dtype: float64
>>> df
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> s[s >= 0.25] = 5
>>> s
0   -0.004321
1    0.000000
2   -0.334768
3    0.000000
4    0.000000
5    0.041812
6    0.097567
7    0.000000
8    5.000000
9    0.000000
Name: A, dtype: float64
```

## where method
* **0105** basic usage of ```where```
```python
>>> df[df >= 0]
          A         B         C         D
0       NaN  0.491618  0.129576  0.711098
1       NaN       NaN  0.672435       NaN
2       NaN       NaN  0.507769  1.186962
3       NaN  0.144294       NaN  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812       NaN       NaN  1.209037
6  0.097567  1.031373       NaN  0.481558
7       NaN  0.914894       NaN       NaN
8  0.447207  1.145699       NaN  0.647402
9  1.713506  0.802310       NaN       NaN
>>> df.where(df >= 0, 0.5)
          A         B         C         D
0  0.500000  0.491618  0.129576  0.711098
1  0.500000  0.500000  0.672435  0.500000
2  0.500000  0.500000  0.507769  1.186962
3  0.500000  0.144294  0.500000  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812  0.500000  0.500000  1.209037
6  0.097567  1.031373  0.500000  0.481558
7  0.500000  0.914894  0.500000  0.500000
8  0.447207  1.145699  0.500000  0.647402
9  1.713506  0.802310  0.500000  0.500000
>>> df
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
```

* **0106** usage of ```where``` with ```inplace```
```python
>>> df2 = df.copy()
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.where(df2 >= 0, 0.5, inplace=True)
>>> df2
          A         B         C         D
0  0.500000  0.491618  0.129576  0.711098
1  0.500000  0.500000  0.672435  0.500000
2  0.500000  0.500000  0.507769  1.186962
3  0.500000  0.144294  0.500000  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812  0.500000  0.500000  1.209037
6  0.097567  1.031373  0.500000  0.481558
7  0.500000  0.914894  0.500000  0.500000
8  0.447207  1.145699  0.500000  0.647402
9  1.713506  0.802310  0.500000  0.500000
>>> df
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
```

## apply method
* **0107** basic usage of ```apply``` method
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.apply(np.sum)
A   -0.472552
B    1.064920
C   -0.159917
D    2.287653
dtype: float64
>>> df2.apply(np.sqrt)
          A         B         C         D
0       NaN  0.701154  0.359966  0.843266
1       NaN       NaN  0.820021       NaN
2       NaN       NaN  0.712579  1.089478
3       NaN  0.379861       NaN  0.253365
4  0.896856  0.284332  0.961851  0.964495
5  0.204481       NaN       NaN  1.099562
6  0.312358  1.015565       NaN  0.693944
7       NaN  0.956501       NaN       NaN
8  0.668735  1.070373       NaN  0.804613
9  1.309010  0.895718       NaN       NaN
>>> df2.apply(np.sin)
          A         B         C         D
0 -0.004321  0.472053  0.129214  0.652666
1 -0.870977 -0.892198  0.622893 -0.447630
2 -0.328550 -0.884227  0.486229  0.927235
3 -0.519527  0.143794 -0.539567  0.064150
4  0.720381  0.080757  0.798715  0.801770
5  0.041800 -0.977673 -0.786335  0.935276
6  0.097413  0.858005 -0.126731  0.463161
7 -0.570575  0.792498 -0.294157 -0.642801
8  0.432449  0.910999 -0.332584  0.603116
9  0.989834  0.718964 -0.154764 -0.978074
>>> df2.apply(np.cos)
          A         B         C         D
0  0.999991  0.881570  0.991617  0.757646
1 -0.491324  0.451645  0.782307  0.894219
2  0.944487  0.467058  0.873832  0.374479
3  0.854454  0.989608  0.841943  0.997940
4  0.693579  0.996734  0.601710  0.597632
5  0.999126  0.210130  0.617801  0.353920
6  0.995244  0.513641  0.991937  0.886274
7  0.821245  0.609875  0.955757  0.766033
8  0.901658  0.412410  0.943074  0.797653
9 -0.142226  0.695048  0.987952 -0.208256
>>> df2.apply(np.tan)
          A         B         C         D
0 -0.004321  0.535468  0.130306  0.861439
1  1.772715 -1.975441  0.796225 -0.500582
2 -0.347861 -1.893186  0.556433  2.476068
3 -0.608022  0.145304 -0.640860  0.064282
4  1.038644  0.081021  1.327409  1.341578
5  0.041837 -4.652711 -1.272797  2.642619
6  0.097878  1.670437 -0.127761  0.522593
7 -0.694768  1.299444 -0.307774 -0.839129
8  0.479615  2.208966 -0.352660  0.756114
9 -6.959576  1.034409 -0.156651  4.696511
```

* **0108** usage of ```apply``` method (1)
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.apply(lambda x: 3 * x)
          A         B         C         D
0 -0.012962  1.474853  0.388728  2.133293
1 -6.253216 -3.306565  2.017304 -1.392340
2 -1.004303 -3.254508  1.523306  3.560885
3 -1.638892  0.432883 -1.709768  0.192582
4  2.413054  0.242534  2.775469  2.790754
5  0.125437 -4.077266 -2.714561  3.627112
6  0.292702  3.094119 -0.381217  1.444675
7 -1.821618  2.744682 -0.895720 -2.094446
8  1.341621  3.437097 -1.017127  1.942207
9  5.140519  2.406931 -0.466165 -5.341762
>>> df2['A'].apply(lambda x: 5 * x)
0    -0.021603
1   -10.422026
2    -1.673838
3    -2.731487
4     4.021757
5     0.209062
6     0.487837
7    -3.036030
8     2.236035
9     8.567532
Name: A, dtype: float64
>>> df2['B'].apply(lambda x: pow(x, 3))
0    0.118818
1   -1.338959
2   -1.276710
3    0.003004
4    0.000528
5   -2.510402
6    1.097103
7    0.765795
8    1.503874
9    0.516448
Name: B, dtype: float64
>>> df2['A'].apply(lambda x: np.sin(x) + np.cos(x) + np.tan(x))
0    0.991349
1    0.410414
2    0.268076
3   -0.273095
4    2.452603
5    1.082763
6    1.190535
7   -0.444098
8    1.813722
9   -6.111968
Name: A, dtype: float64
```

* **0109** usage of ```apply``` method (2) (using ```axis```)
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.apply(np.sum, axis = 0)
A   -0.472552
B    1.064920
C   -0.159917
D    2.287653
dtype: float64
>>> df2.apply(np.sum, axis = 1)
0    1.327970
1   -2.978272
2    0.275126
3   -0.907732
4    2.740604
5   -1.013092
6    1.483426
7   -0.689034
8    1.901266
9    0.579841
dtype: float64
>>> df2.apply(lambda x: x['A'] + x['B'], axis = 1)
0    0.487297
1   -3.186594
2   -1.419604
3   -0.402003
4    0.885196
5   -1.317276
6    1.128940
7    0.307688
8    1.592906
9    2.515817
dtype: float64
>>> df2.apply(lambda x: x['A'] >= x['B'], axis = 1)
0    False
1    False
2     True
3    False
4     True
5     True
6    False
7    False
8    False
9     True
dtype: bool
>>> df2.apply(lambda x: x['A'] >= x['B'] and x['B'] >= x['C'], axis = 1)
0    False
1    False
2    False
3    False
4    False
5    False
6    False
7    False
8    False
9     True
dtype: bool
```

* **0110** usage of ```apply``` method (3)
```python
>>> df2
          A         B         C         D
0 -0.004321  0.491618  0.129576  0.711098
1 -2.084405 -1.102188  0.672435 -0.464113
2 -0.334768 -1.084836  0.507769  1.186962
3 -0.546297  0.144294 -0.569923  0.064194
4  0.804351  0.080845  0.925156  0.930251
5  0.041812 -1.359089 -0.904854  1.209037
6  0.097567  1.031373 -0.127072  0.481558
7 -0.607206  0.914894 -0.298573 -0.698149
8  0.447207  1.145699 -0.339042  0.647402
9  1.713506  0.802310 -0.155388 -1.780587
>>> df2.apply(lambda x: [x['A'] + x['B'], x['C'] + x['D'], x['A'] * x['C'] * x['D']], axis = 1, result_type = 'reduce')
0    [0.48729690056671937, 0.8406734107120655, -0.0...
1    [-3.186593546733177, 0.20832142443694146, 0.65...
2    [-1.4196036917861528, 1.6947301065005855, -0.2...
3    [-0.4020031597256417, -0.5057288015995078, 0.0...
4    [0.8851960269528993, 1.855407860437293, 0.6922...
5    [-1.3172760746543144, 0.30418366448715783, -0....
6    [1.1289404683513427, 0.35448575205515576, -0.0...
7    [0.30768804575293274, -0.99672221774079, -0.12...
8    [1.592905936994613, 0.30836002195560797, -0.09...
9    [2.5158166774160744, -1.935975590834805, 0.474...
dtype: object
>>> df2.apply(lambda x: [x['A'] + x['B'], x['C'] + x['D'], x['A'] * x['C'] * x['D']], axis = 1, result_type = 'expand')
          0         1         2
0  0.487297  0.840673 -0.000398
1 -3.186594  0.208321  0.650514
2 -1.419604  1.694730 -0.201765
3 -0.402003 -0.505729  0.019987
4  0.885196  1.855408  0.692247
5 -1.317276  0.304184 -0.045743
6  1.128940  0.354486 -0.005970
7  0.307688 -0.996722 -0.126571
8  1.592906  0.308360 -0.098161
9  2.515817 -1.935976  0.474097
>>> df2.apply(lambda x: [x['A'] + x['B'], x['C'] + x['D'], x['A'] * x['C'] * x['D']], axis = 1)
0    [0.48729690056671937, 0.8406734107120655, -0.0...
1    [-3.186593546733177, 0.20832142443694146, 0.65...
2    [-1.4196036917861528, 1.6947301065005855, -0.2...
3    [-0.4020031597256417, -0.5057288015995078, 0.0...
4    [0.8851960269528993, 1.855407860437293, 0.6922...
5    [-1.3172760746543144, 0.30418366448715783, -0....
6    [1.1289404683513427, 0.35448575205515576, -0.0...
7    [0.30768804575293274, -0.99672221774079, -0.12...
8    [1.592905936994613, 0.30836002195560797, -0.09...
9    [2.5158166774160744, -1.935975590834805, 0.474...
dtype: object
```

## advanced apply method examples
* **0111** advanced usage of ```apply``` method (1)
```python
>>> df2
          A         B         C         D
0 -2.947849 -0.501904  0.149240 -0.849129
1 -0.495403 -0.865729  1.161844  1.999170
2  0.345632 -1.142305  0.043301  0.189707
3  0.194324  1.167938  0.181214 -0.118479
4  2.119812 -0.241975 -0.026610  0.073835
5 -0.176964 -1.420451  1.313049  0.851216
6  1.752264 -0.552000 -0.098575 -1.133627
7  0.050185 -0.535216  0.314897 -0.430522
8  0.098421  0.683587 -0.911869 -0.646262
9  1.248256  1.016505  1.456663 -1.236070
>>> df2.apply(lambda x: 1 if (x['A'] - df2['A'].mean()) / df2['A'].std() >= 0.5 else 0, axis = 1)
0    0
1    0
2    0
3    0
4    1
5    0
6    1
7    0
8    0
9    1
dtype: int64
>>> df2
          A         B         C         D
0 -2.947849 -0.501904  0.149240 -0.849129
1 -0.495403 -0.865729  1.161844  1.999170
2  0.345632 -1.142305  0.043301  0.189707
3  0.194324  1.167938  0.181214 -0.118479
4  2.119812 -0.241975 -0.026610  0.073835
5 -0.176964 -1.420451  1.313049  0.851216
6  1.752264 -0.552000 -0.098575 -1.133627
7  0.050185 -0.535216  0.314897 -0.430522
8  0.098421  0.683587 -0.911869 -0.646262
9  1.248256  1.016505  1.456663 -1.236070
>>> df2['A'] = df2.apply(lambda x: 1 if (x['A'] - df2['A'].mean()) / df2['A'].std() >= 0.5 else 0, axis = 1)
>>> df2
   A         B         C         D
0  0 -0.501904  0.149240 -0.849129
1  0 -0.865729  1.161844  1.999170
2  0 -1.142305  0.043301  0.189707
3  0  1.167938  0.181214 -0.118479
4  1 -0.241975 -0.026610  0.073835
5  0 -1.420451  1.313049  0.851216
6  1 -0.552000 -0.098575 -1.133627
7  0 -0.535216  0.314897 -0.430522
8  0  0.683587 -0.911869 -0.646262
9  1  1.016505  1.456663 -1.236070
```

* **0112** advanced usage of ```apply``` method (2)
```python
>>> df2 = df.copy()
>>> df2
          A         B         C         D
0 -2.947849 -0.501904  0.149240 -0.849129
1 -0.495403 -0.865729  1.161844  1.999170
2  0.345632 -1.142305  0.043301  0.189707
3  0.194324  1.167938  0.181214 -0.118479
4  2.119812 -0.241975 -0.026610  0.073835
5 -0.176964 -1.420451  1.313049  0.851216
6  1.752264 -0.552000 -0.098575 -1.133627
7  0.050185 -0.535216  0.314897 -0.430522
8  0.098421  0.683587 -0.911869 -0.646262
9  1.248256  1.016505  1.456663 -1.236070
>>> 
>>> A_mean = df2['A'].mean()
>>> A_std = df2['A'].std()
>>> df2['A'] = df2.apply(lambda x: 1 if (x['A'] - A_mean) / A_std >= 0.5 else 0, axis = 1)
>>> df2
   A         B         C         D
0  0 -0.501904  0.149240 -0.849129
1  0 -0.865729  1.161844  1.999170
2  0 -1.142305  0.043301  0.189707
3  0  1.167938  0.181214 -0.118479
4  1 -0.241975 -0.026610  0.073835
5  0 -1.420451  1.313049  0.851216
6  1 -0.552000 -0.098575 -1.133627
7  0 -0.535216  0.314897 -0.430522
8  0  0.683587 -0.911869 -0.646262
9  1  1.016505  1.456663 -1.236070
```

* **0113** advanced usage of ```apply``` method (3)
```python
>>> def sign(x):
	if x > 0:
		return 1
	elif x == 0:
		return 0
	else:
		return -1
>>> df2['E'] = df2.apply(lambda x: sum([sign(y) for y in x]), axis = 1)
>>> df2
          A         B         C         D  E
0 -2.947849 -0.501904  0.149240 -0.849129 -2
1 -0.495403 -0.865729  1.161844  1.999170  0
2  0.345632 -1.142305  0.043301  0.189707  2
3  0.194324  1.167938  0.181214 -0.118479  2
4  2.119812 -0.241975 -0.026610  0.073835  0
5 -0.176964 -1.420451  1.313049  0.851216  0
6  1.752264 -0.552000 -0.098575 -1.133627 -2
7  0.050185 -0.535216  0.314897 -0.430522  0
8  0.098421  0.683587 -0.911869 -0.646262  0
9  1.248256  1.016505  1.456663 -1.236070  2
>>> df2['F'] = df2.apply(lambda x: sum([sign(y) for y in x[['A', 'B', 'C']]]), axis = 1)
>>> df2
          A         B         C         D  E  F
0 -2.947849 -0.501904  0.149240 -0.849129 -2 -1
1 -0.495403 -0.865729  1.161844  1.999170  0 -1
2  0.345632 -1.142305  0.043301  0.189707  2  1
3  0.194324  1.167938  0.181214 -0.118479  2  3
4  2.119812 -0.241975 -0.026610  0.073835  0 -1
5 -0.176964 -1.420451  1.313049  0.851216  0 -1
6  1.752264 -0.552000 -0.098575 -1.133627 -2 -1
7  0.050185 -0.535216  0.314897 -0.430522  0  1
8  0.098421  0.683587 -0.911869 -0.646262  0  1
9  1.248256  1.016505  1.456663 -1.236070  2  3
```

* **0114** advanced usage of ```apply``` method (4)
```python
>>> df2['G'] = df2.apply(lambda x: np.mean(df2[df2['E'] == x['E']]['C']), axis = 1)
>>> df2
          A         B         C         D  E  F         G
0 -2.947849 -0.501904  0.149240 -0.849129 -2 -1  0.025332
1 -0.495403 -0.865729  1.161844  1.999170  0 -1  0.370262
2  0.345632 -1.142305  0.043301  0.189707  2  1  0.560393
3  0.194324  1.167938  0.181214 -0.118479  2  3  0.560393
4  2.119812 -0.241975 -0.026610  0.073835  0 -1  0.370262
5 -0.176964 -1.420451  1.313049  0.851216  0 -1  0.370262
6  1.752264 -0.552000 -0.098575 -1.133627 -2 -1  0.025332
7  0.050185 -0.535216  0.314897 -0.430522  0  1  0.370262
8  0.098421  0.683587 -0.911869 -0.646262  0  1  0.370262
9  1.248256  1.016505  1.456663 -1.236070  2  3  0.560393
>>> df2['H'] = df2.apply(lambda x: np.mean(df2[abs(df2['A'] - x['A']) < 0.25]['D']), axis = 1)
>>> df2
          A         B         C         D  E  F         G         H
0 -2.947849 -0.501904  0.149240 -0.849129 -2 -1  0.025332 -0.849129
1 -0.495403 -0.865729  1.161844  1.999170  0 -1  0.370262  1.999170
2  0.345632 -1.142305  0.043301  0.189707  2  1  0.560393 -0.191678
3  0.194324  1.167938  0.181214 -0.118479  2  3  0.560393 -0.251389
4  2.119812 -0.241975 -0.026610  0.073835  0 -1  0.370262  0.073835
5 -0.176964 -1.420451  1.313049  0.851216  0 -1  0.370262  0.210347
6  1.752264 -0.552000 -0.098575 -1.133627 -2 -1  0.025332 -1.133627
7  0.050185 -0.535216  0.314897 -0.430522  0  1  0.370262 -0.086012
8  0.098421  0.683587 -0.911869 -0.646262  0  1  0.370262 -0.251389
9  1.248256  1.016505  1.456663 -1.236070  2  3  0.560393 -1.236070
>>> df2['I'] = df2.apply(lambda x: np.sum(df2[x['A'] > df2['A']]['B']), axis = 1)
>>> df2
          A         B         C         D  E  F         G         H         I
0 -2.947849 -0.501904  0.149240 -0.849129 -2 -1  0.025332 -0.849129  0.000000
1 -0.495403 -0.865729  1.161844  1.999170  0 -1  0.370262  1.999170 -0.501904
2  0.345632 -1.142305  0.043301  0.189707  2  1  0.560393 -0.191678 -1.471774
3  0.194324  1.167938  0.181214 -0.118479  2  3  0.560393 -0.251389 -2.639713
4  2.119812 -0.241975 -0.026610  0.073835  0 -1  0.370262  0.073835 -2.149574
5 -0.176964 -1.420451  1.313049  0.851216  0 -1  0.370262  0.210347 -1.367634
6  1.752264 -0.552000 -0.098575 -1.133627 -2 -1  0.025332 -1.133627 -1.597574
7  0.050185 -0.535216  0.314897 -0.430522  0  1  0.370262 -0.086012 -2.788084
8  0.098421  0.683587 -0.911869 -0.646262  0  1  0.370262 -0.251389 -3.323300
9  1.248256  1.016505  1.456663 -1.236070  2  3  0.560393 -1.236070 -2.614079
>>> df2['J'] = df2.apply(lambda x: pow(np.sum(df2[x['A'] > df2['A']]['A']), 2), axis = 1)
>>> df2
          A         B         C  ...         H         I          J
0 -2.947849 -0.501904  0.149240  ... -0.849129  0.000000   0.000000
1 -0.495403 -0.865729  1.161844  ...  1.999170 -0.501904   8.689816
2  0.345632 -1.142305  0.043301  ... -0.191678 -1.471774  10.740611
3  0.194324  1.167938  0.181214  ... -0.251389 -2.639713  12.052085
4  2.119812 -0.241975 -0.026610  ...  0.073835 -2.149574   0.004742
5 -0.176964 -1.420451  1.313049  ...  0.210347 -1.367634  11.855990
6  1.752264 -0.552000 -0.098575  ... -1.133627 -1.597574   2.833832
7  0.050185 -0.535216  0.314897  ... -0.086012 -2.788084  13.105968
8  0.098421  0.683587 -0.911869  ... -0.251389 -3.323300  12.745129
9  1.248256  1.016505  1.456663  ... -1.236070 -2.614079   8.594599

[10 rows x 10 columns]
```
